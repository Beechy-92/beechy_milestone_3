{% extends "still_mind/base.html" %}

{% block title %}Posts • StillMind{% endblock %}

{% block content %}
<h1 class="h3 mb-3">Recent Posts</h1>

<form method="get" class="row g-2 mb-3">
  <div class="col-sm-6 col-md-4">
    <input type="text"
           name="q"
           class="form-control"
           placeholder="Search by title, mood, or text…"
           value="{{ request.GET.q }}">
  </div>

  <div class="col-sm-6 col-md-4">
    <div class="btn-group" role="group">
      <a href="{% url 'still_mind:post_list' %}"
         class="btn btn-sm btn-outline-secondary{% if not request.GET.status %} active{% endif %}">
        All
      </a>
      <a href="?status=published{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"
         class="btn btn-sm btn-outline-success{% if request.GET.status == 'published' %} active{% endif %}">
        Published
      </a>
      <a href="?status=draft{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"
         class="btn btn-sm btn-outline-warning{% if request.GET.status == 'draft' %} active{% endif %}">
        Drafts
      </a>
    </div>
  </div>

  <div class="col-sm-12 col-md-4">
    <button type="submit" class="btn btn-sm btn-primary">
      Search
    </button>
    <a href="{% url 'still_mind:post_list' %}" class="btn btn-sm btn-outline-secondary">
      Clear
    </a>
  </div>
</form>

<a href="{% url 'still_mind:post_create' %}" class="btn btn-primary mb-3">
  New Post
</a>

{% if object_list %}
  <ul class="list-group">
    {% for post in object_list %}
      <li class="list-group-item">
        <a href="{% url 'still_mind:post_detail' slug=post.slug %}">
          {{ post.title }}
        </a>

        {% if post.summary %}
          <p class="mb-1">{{ post.summary }}</p>
        {% endif %}

        <small class="text-muted">
          {{ post.created_at|date:"M d, Y H:i" }}
          | Mood: {{ post.mood|default:"(none)" }}
          | Status: {{ post.get_status_display }}
        </small>
      </li>
    {% endfor %}
  </ul>
{% else %}
  {# No posts in the queryset #}
  {% if request.GET.q or request.GET.status %}
    <div class="alert alert-info mt-3">
      No posts match your current search or filters.
      <a href="{% url 'still_mind:post_list' %}" class="alert-link">Clear filters</a>
      to see all of your entries.
    </div>
  {% else %}
    <div class="text-center py-5">
      <h2 class="h4 mb-3">No journal entries yet</h2>
      <p class="mb-4">
        You haven’t created any reflections. When you do, they’ll appear here.
      </p>
      <a href="{% url 'still_mind:post_create' %}" class="btn btn-primary">
        Create your first entry
      </a>
    </div>
  {% endif %}
{% endif %}

{% endblock %}